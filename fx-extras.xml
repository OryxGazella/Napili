<!--
  ~ Copyright 2012 by the original author or authors.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->
<project name="Napili" default="default" basedir="."
         xmlns:fx="javafx:com.sun.javafx.tools.ant">
    <description>Builds, tests, and runs the project Napili.</description>

    <target name="testThis" description="testevent">
        <property name="test.test.test" value="test worked!"/>
        <echo message="TEST!"/>
        <echo message="${javafxAntJar}"/>
        <echo message="${app.vendor}"/>
        <echo message="${build.classes.dir}" />
    </target>

    <target name="_dist-native" depends="classes, libcopy"
            description="Builds native distributions via JavaFX">
        <taskdef resource="com/sun/javafx/tools/ant/antlib.xml"
                 uri="javafx:com.sun.javafx.tools.ant"
                 classpath="${javafxAntJar}"/>

        <fx:application id="NapiliApp"
                        name="Napili Turtle Graphics"
                        mainClass="${app.main.class}" />

        <fx:resources id="libRes">
            <fx:fileset dir="dist" includes="libs/*.jar" type="jar" requiredFor="startup"/>
        </fx:resources>


        <fx:jar destfile="dist/Napili.jar">
            <!-- Define what to launch -->
            <fx:application refid="NapiliApp"/>

            <!-- Define what classpath to use -->
            <fx:resources refid="libRes"/>

            <manifest>
                <attribute name="Implementation-Vendor"
                           value="${app.vendor}"/>
                <attribute name="Implementation-Title"
                           value="${app.title}"/>
                <attribute name="Implementation-Version"
                           value="${app.version}"/>
            </manifest>

            <!-- Define what files to include -->
            <fileset dir="${buildDir}/classes/main"/>
            <fileset dir="dist/libs/" includes="*.jar"/>
        </fx:jar>


        <fx:deploy width="${app.width}" height="${app.height}"
                   nativeBundles="all"
                   outdir="dist" outfile="${app.title}">
            <fx:application name="${app.title}"
                            mainClass="${app.main.class}"/>
            <fx:resources>
                <fx:fileset dir="${buildDir}"
                            includes="*.jar"/>
            </fx:resources>
            <fx:info title="${app.title}"
                     vendor="${app.vendor}"/>
        </fx:deploy>
    </target>


</project>
